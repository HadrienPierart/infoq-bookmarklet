javascript:(function(){"use strict";function e(){function e(){if(window.jQuery.ui)t();else{var e=document.createElement("script");e.src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js",e.onload=t,document.body.appendChild(e);var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href","http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/vader/jquery-ui.css"),document.getElementsByTagName("head")[0].appendChild(n)}}function t(){if("undefined"==typeof h2m){var e=document.createElement("script");e.src="https://rawgit.com/mathiasbynens/he/master/he.js",document.body.appendChild(e);var t=document.createElement("script");t.src="https://cdn.rawgit.com/domchristie/to-markdown/v0.0.3/src/to-markdown.js",t.onload=n,document.body.appendChild(t)}else n()}function n(){var e="position: absolute; top: 10px; left: 6px; text-align: center; background: #3498db; background-image: linear-gradient(to bottom, #3498db, #2980b9); border-radius: 10px; box-shadow: 2px 2px 2px #666666; font-family: Arial; color: #ffffff; font-size: 18px; padding: 5px 13px; border: solid #1f628d 2px; text-decoration: none; cursor:pointer;",t=$('<div id="markdownRendered"><textarea id="mdToCopy" cols="80" rows="40" style="display: block; margin: auto; padding: 10px;"></textarea><button onclick="saveTextAsFile()" style="'+e+'">Download</button></div>');t.appendTo("body");var n=$("#markdownRendered");n.dialog({height:600,width:1e3,modal:!0});var a=$("#mdToCopy");a.val("Converting...");var i=$(".text_content_container>.text_info").clone();i=i.find(".related_sponsors").remove().end().find(".clear").remove().end().find("#lowerFullwidthVCR").remove().end().html(),i=i.replace(/img(.*?)src="(\/resource\/)/g,'img$1src="http://www.infoq.com$2').replace(/&nbsp;/g, ' ').replace(/(<pre\b[^>]*>)/g,"$1\n").replace(/(<\/pre>)/g,"\n$1");var r="";-1!==document.URL.indexOf("www.infoq.com/news")?r=o.news:-1!==document.URL.indexOf("www.infoq.com/article")&&(r=o.news);var d=[];$(".random_links ul li").each(function(e,t){d.push($(t).text())}),d=d.slice(d.indexOf("Topics")+1);var c=r.replace(/\$\{title\}/g,document.title).replace(/\$\{topics\}/g,"\n    - "+d.join("\n    - ")+"\n").replace(/\$\{summary\}/g,$("meta[name=description]").attr("content"));c+=toMarkdown(i.split('<div class="random_links">')[0]),$(".ui-dialog").zIndex(1e4),a.val(c)}var o={news:"\n* Title: ${title}\n* Translator:\n* Topics: ${topics}\n* Summary (max 400 chars): ${summary}\n\n---------------------------------------\n\n",article:"\n* Title: ${title}\n* Translator:\n* Topics: ${topics}\n* Short Summary (200 chars max): ${summaryShort}\n* Summary (max 400 chars) : ${summary}\n\n---------------------------------------\n\n"};if($=window.jQuery)e();else{var a=document.createElement("script");a.src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js",a.onload=e,document.body.appendChild(a)}window.saveTextAsFile=function(){var e=document.getElementById("mdToCopy").value,t=new Blob([e],{type:"text/plain"}),n=window.location.pathname.split("/"),o=n[n.length-1]+".md",a=document.createElement("a");a.download=o,a.innerHTML="Download File",null!=window.webkitURL?a.href=window.webkitURL.createObjectURL(t):(a.href=window.URL.createObjectURL(t),a.onclick=function(e){document.body.removeChild(e.target)},a.style.display="none",document.body.appendChild(a)),a.click()}}-1!==document.URL.indexOf("www.infoq.com/")||-1!==window.location.href.indexOf("www.infoq.com/")?e():alert("This bookmarklet only works on infoQ pages.")})();